#### 2030773 李昊洋

**1.16** 用成套方法来求解一般的四参数递归式：
$$
g(1)=\alpha;\\g(2n+j)=3g(n)_+\gamma n+\beta_j; \ \ \ \ \ \ \ j=0,1,n\ge1.
$$
提示：尝试用函数$g(n)=n$ .

**解：** 设$g(n)=a(n)\alpha+b(n)\beta_0+c(n)\beta_1+d(n)\gamma$ 

由（1.18）知，当$n=(1b_{m-1}...b_1b_0)_2$ 时有 $a(n)\alpha+b(n)\beta_0+c(n)\beta_1=(\alpha\beta_{b_{m-1}}\beta_{b_{m-2}}...\beta_{b_{1}}\beta_{b_{0}})_3$ 

取$g(n)=n$ 得
$$
1=\alpha\\
2n=3n+\gamma n+\beta_0\\
2n+1=3n+\gamma n+\beta_1\\
\alpha=1, \beta_0=0, \beta_1=1, \gamma = -1
$$
所以，$n=a(n)+c(n)-d(n)$ 

取$g(n)=1$ 得
$$
1=\alpha\\
1=3+\gamma n+\beta_0\\
1=3+\gamma n+\beta_1\\
\alpha=1, \beta_0=-2, \beta_1=-2, \gamma = 0
$$
所以，$1=a(n)-2b(n)-2c(n)$ 

于是就可以解出递推式。



**1.17** 当有4根而不是3根桩柱时，如果$W_n$ 是将一个有 $n$ 个圆盘的塔从一根桩柱移动到另一根桩柱所需要的最少移动次数，证明

$W_{n(n+1)/2}\le2W_{n(n-1)/2}+T_n,\ \ \ n>0$ .

（这里$T_n=2^n-1$ 是3根桩柱时所需要的最少移动次数. ）利用这个结果求出 $f(n)$ 的一个封闭形式，使得所有 $n\ge0$ 都有 $W_{n(n+1)/2}\le f(n)$ .

**解：** 对于$0\le k \le m$ ，有 $W_m \le 2 W_{m-k}+T_k$ ，考虑下述流程：

- 将最上面的 $m-k$ 个圆盘移动到一根桩柱上，消耗 $W_{m-k}$ 步
- 仅有三根桩柱将剩余的 $k$ 个圆盘移动到另一根桩柱上，消耗 $T_n$ 步
- 将上面的 $m-k$ 个圆盘移动到大圆盘所在的桩柱上，消耗 $W_{m-k}$ 步

所以当$m=n(n+1)/2$ 时，有$W_{n(n+1)/2}\le2W_{n(n-1)/2}+T_n,\ \ \ n>0$ 

设 $Y_n=(W_{n(n+1)/2}-1)/2^n$
$$
Y_n<=(2W_{n(n-1)/2}+2^n-1-1)/2^n=Y_{n-1}+1
$$
于是，$W_{n(n+1)/2}\le2^n(n-1)+1$ .

